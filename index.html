<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Summer Trip 2025: Chuy·∫øn ƒêi 9 Ng√†y</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- The Chart.js script will be moved to the end of the body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 250px;
            width: 250px;
        }
        .nav-button.active {
            background-color: #334155; /* slate-700 */
            color: white;
            font-weight: 600;
        }
        .tab-button.active {
            border-color: #fb923c; /* orange-400 */
            color: #ea580c; /* orange-600 */
            font-weight: 600;
        }
        [data-tab-content] {
            display: none;
        }
        .active[data-tab-content] {
            display: block;
        }
        html {
            scroll-behavior: smooth;
        }
        .update-feedback {
            transition: opacity 1s ease-out;
        }
        /* Custom Modal Styles */
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal.flex {
            display: flex;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="text-center py-8 md:py-12 bg-white shadow-sm">
        <h1 class="text-4xl md:text-5xl font-bold text-slate-800">H√†nh Tr√¨nh Xuy√™n Vi·ªát 9 Ng√†y</h1>
        <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto px-4">T·ª± do t√πy ch·ªânh k·∫ø ho·∫°ch, chi ph√≠ v√† ho·∫°t ƒë·ªông cho chuy·∫øn ƒëi c·ªßa ri√™ng b·∫°n.</p>
    </header>

    <nav id="day-nav" class="sticky top-0 z-10 bg-white/80 backdrop-blur-lg shadow-md py-3 overflow-x-auto">
        <div class="container mx-auto flex justify-center items-center space-x-2 px-4">
        </div>
    </nav>

    <main id="itinerary-container" class="container mx-auto px-4 py-8 md:py-12">
        <!-- Itinerary cards will be dynamically inserted here -->
    </main>

    <footer class="text-center py-6 bg-slate-800 text-slate-300 mt-8">
        <p>&copy; 2025 K·∫ø Ho·∫°ch Chuy·∫øn ƒêi. Ch√∫c b·∫°n c√≥ m·ªôt h√†nh tr√¨nh an to√†n v√† ƒë√°ng nh·ªõ!</p>
    </footer>

    <!-- Password and Alert Modals -->
    <div id="password-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg p-6 md:p-8 shadow-xl max-w-sm w-full">
            <h3 class="text-xl font-bold mb-4 text-slate-800">Y√™u C·∫ßu M·∫≠t Kh·∫©u</h3>
            <p class="mb-4 text-slate-600">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ c·∫≠p nh·∫≠t k·∫ø ho·∫°ch.</p>
            <input type="password" id="password-input" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 mb-4 p-2">
            <div class="flex justify-end space-x-3">
                <button id="modal-cancel" class="px-5 py-2 bg-slate-200 text-slate-700 font-semibold rounded-lg hover:bg-slate-300 transition-colors">H·ªßy</button>
                <button id="modal-confirm" class="px-5 py-2 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition-colors">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <div id="alert-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg p-8 shadow-xl max-w-sm w-full text-center">
            <p id="alert-message" class="mb-6 text-lg text-slate-700">M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng.</p>
            <button id="alert-ok" class="px-8 py-2 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition-colors">OK</button>
        </div>
    </div>
    
    <!-- Scripts moved to the end for robust loading -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const tripData = [
            {
                day: 1, route: "H√† N·ªôi ‚Üí Hu·∫ø", distance: "~700 km",
                activities: ["Xu·∫•t ph√°t s·ªõm t·ª´ H√† N·ªôi.", "ƒÇn tr∆∞a t·∫°i th√†nh ph·ªë Vinh.", "ƒê·∫øn Hu·∫ø nh·∫≠n ph√≤ng v√† ngh·ªâ ng∆°i."],
                accommodation: ["T·∫ßm trung: √äMM Hotel, Century Riverside", "Cao c·∫•p: Melia Vinpearl Hue"],
                food: ["Tr∆∞a: C∆°m/Ch√°o t·∫°i Vinh.", "T·ªëi: B√∫n b√≤, C∆°m h·∫øn, c√°c lo·∫°i b√°nh Hu·∫ø."],
                foodCost: 1500000, accommodationCost: 2750000, otherCost: 300000
            },
            {
                day: 2, route: "Hu·∫ø ‚Üí MƒÉng ƒêen", distance: "~350 km",
                activities: ["Tham quan ƒê·∫°i N·ªôi Hu·∫ø.", "ƒÇn tr∆∞a t·∫°i Hu·∫ø v√† kh·ªüi h√†nh ƒëi MƒÉng ƒêen."],
                accommodation: ["T·∫ßm trung: Mountain Lodge, T&T Hotel", "Cao c·∫•p: Golden Boutique Hotel"],
                food: ["S√°ng: B√∫n b√≤ Hu·∫ø.", "Tr∆∞a: C∆°m ni√™u, ƒë·∫∑c s·∫£n Hu·∫ø.", "T·ªëi: ƒê·∫∑c s·∫£n n√∫i r·ª´ng MƒÉng ƒêen."],
                foodCost: 2000000, accommodationCost: 2600000, otherCost: 200000
            },
            {
                day: 3, route: "Kh√°m ph√° MƒÉng ƒêen", distance: "T·∫°i ch·ªó",
                activities: ["Tham quan H·ªì ƒêƒÉk Ke, Th√°c Pa S·ªπ.", "D·∫°o ch∆°i r·ª´ng th√¥ng, thƒÉm T∆∞·ª£ng ƒê·ª©c M·∫π."],
                accommodation: ["Nh∆∞ tr√™n"],
                food: ["S√°ng: B√°nh canh c√° l√≥c.", "Tr∆∞a/T·ªëi: G√† n∆∞·ªõng, c∆°m lam t·∫°i Qu√°n C√¥ Sinh; L·∫©u xuy√™n ti√™u t·∫°i MƒÉng ƒêen L·ªØ Qu√°n."],
                foodCost: 2050000, accommodationCost: 2600000, otherCost: 500000
            },
            {
                day: 4, route: "MƒÉng ƒêen ‚Üí BMT", distance: "~280 km",
                activities: ["R·ªùi MƒÉng ƒêen.", "Gh√© Bi·ªÉn H·ªì T'n∆∞ng (Pleiku).", "ƒÇn tr∆∞a t·∫°i Pleiku, chi·ªÅu ƒë·∫øn Bu√¥n Ma Thu·ªôt."],
                accommodation: ["T·∫ßm trung: Elephants Hotel, S√†i G√≤n-Ban M√™", "Cao c·∫•p: M∆∞·ªùng Thanh Luxury BMT"],
                food: ["S√°ng: Ph·ªü ƒë·ªãa ph∆∞∆°ng.", "Tr∆∞a: Ph·ªü kh√¥ Gia Lai.", "T·ªëi: B√∫n ƒë·ªè, ƒë·∫∑c s·∫£n BMT."],
                foodCost: 1500000, accommodationCost: 2350000, otherCost: 150000
            },
            {
                day: 5, route: "BMT ‚Üí Quy Nh∆°n", distance: "~230 km",
                activities: ["Tham quan KDL Bu√¥n ƒê√¥n.", "ƒÇn tr∆∞a v√† kh·ªüi h√†nh ƒëi Quy Nh∆°n."],
                accommodation: ["T·∫ßm trung: Anya Premier, Seaside Boutique", "Cao c·∫•p: Anantara, FLC Resort"],
                food: ["S√°ng: B√∫n ƒë·ªè, b√°nh cu·ªën.", "Tr∆∞a: C∆°m lam, g√† n∆∞·ªõng.", "T·ªëi: Th∆∞·ªüng th·ª©c h·∫£i s·∫£n Quy Nh∆°n."],
                foodCost: 2000000, accommodationCost: 3500000, otherCost: 400000
            },
            {
                day: 6, route: "Kh√°m ph√° Quy Nh∆°n", distance: "T·∫°i ch·ªó",
                activities: ["Tham quan Eo Gi√≥, K·ª≥ Co.", "Gh√© Th√°p ƒê√¥i, Gh·ªÅnh R√°ng."],
                accommodation: ["Nh∆∞ tr√™n"],
                food: ["S√°ng: B√∫n c√° Quy Nh∆°n.", "Tr∆∞a: B√°nh x√®o t√¥m nh·∫£y Gia V·ªπ.", "T·ªëi: H·∫£i s·∫£n ven bi·ªÉn ho·∫∑c ·ªêc Th√∫y Ki·ªÅu."],
                foodCost: 2250000, accommodationCost: 3500000, otherCost: 600000
            },
            {
                day: 7, route: "Quy Nh∆°n ‚Üí H·ªôi An", distance: "~300 km",
                activities: ["T·∫≠n h∆∞·ªüng bu·ªïi s√°ng t·∫°i Quy Nh∆°n.", "Chi·ªÅu ƒë·∫øn Bi·ªÉn An B√†ng.", "T·ªëi d·∫°o ch∆°i Ph·ªë c·ªï H·ªôi An."],
                accommodation: ["T·∫ßm trung: An Bang Beach Hideaway", "Cao c·∫•p: Sol An Bang Beach Resort"],
                food: ["S√°ng: ƒê·∫∑c s·∫£n Quy Nh∆°n.", "Tr∆∞a: D·ª´ng ƒÉn tr√™n ƒë∆∞·ªùng.", "T·ªëi: Cao l·∫ßu, c∆°m g√† B√† Bu·ªôi, b√°nh m√¨ Ph∆∞·ª£ng."],
                foodCost: 1800000, accommodationCost: 3250000, otherCost: 250000
            },
            {
                day: 8, route: "H·ªôi An ‚Üí Vinh", distance: "~440 km",
                activities: ["T·∫Øm bi·ªÉn ho·∫∑c c√† ph√™ ph·ªë c·ªï.", "ƒÇn tr∆∞a t·∫°i ƒê·ªìng H·ªõi/H√† Tƒ©nh.", "T·ªëi ƒë·∫øn Vinh v√† ngh·ªâ ng∆°i."],
                accommodation: ["Kh√°ch s·∫°n: M∆∞·ªùng Thanh Luxury S√¥ng Lam, M∆∞·ªùng Thanh Grand Ph∆∞∆°ng ƒê√¥ng."],
                food: ["S√°ng: M√¨ Qu·∫£ng/Cao L·∫ßu.", "Tr∆∞a: C∆°m ƒë·ªãa ph∆∞∆°ng.", "T·ªëi: Ch√°o/S√∫p l∆∞∆°n Ngh·ªá An."],
                foodCost: 1500000, accommodationCost: 2000000, otherCost: 100000
            },
            {
                day: 9, route: "Vinh ‚Üí H√† N·ªôi", distance: "~296 km",
                activities: ["Tham quan Qu·∫£ng tr∆∞·ªùng HCM ho·∫∑c ngh·ªâ ng∆°i.", "ƒÇn tr∆∞a t·∫°i Thanh H√≥a v√† tr·ªü v·ªÅ H√† N·ªôi."],
                accommodation: ["V·ªÅ nh√†"],
                food: ["S√°ng: ƒê·∫∑c s·∫£n Vinh.", "Tr∆∞a: C∆°m ƒë·ªãa ph∆∞∆°ng."],
                foodCost: 1000000, accommodationCost: 0, otherCost: 50000
            }
        ];

        const itineraryContainer = document.getElementById('itinerary-container');
        const dayNavContainer = document.querySelector('#day-nav .container');
        const charts = [];

        function renderApp() {
            itineraryContainer.innerHTML = '';
            dayNavContainer.innerHTML = '';
            charts.length = 0;

            tripData.forEach((dayData, index) => {
                const dayId = `day-${dayData.day}`;
                const totalCost = dayData.foodCost + dayData.accommodationCost + dayData.otherCost;

                const navButton = `<a href="#${dayId}" class="nav-button whitespace-nowrap text-sm md:text-base px-3 py-2 rounded-md text-slate-600 hover:bg-slate-200 transition-colors duration-300">Ng√†y ${dayData.day}</a>`;
                dayNavContainer.innerHTML += navButton;
                
                const cardHTML = `
                    <section id="${dayId}" class="day-card bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-12 scroll-mt-24">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div class="md:col-span-2">
                                <h2 class="text-3xl font-bold text-slate-800 mb-2">Ng√†y ${dayData.day}: ${dayData.route}</h2>
                                <p class="text-slate-500 font-medium mb-6">Qu√£ng ƒë∆∞·ªùng: ${dayData.distance}</p>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label for="activity-details-${dayId}" class="text-xl font-semibold text-slate-700 mb-3 block">üìù Ho·∫°t ƒë·ªông ch√≠nh</label>
                                        <textarea id="activity-details-${dayId}" rows="4" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500">${dayData.activities.join('\n')}</textarea>
                                    </div>

                                    <div class="tabs pt-4">
                                        <h3 class="text-xl font-semibold text-slate-700 mb-3">üí∞ Chi ph√≠ & Chi ti·∫øt</h3>
                                        <div class="flex border-b border-slate-200 mb-4">
                                            <button data-tab-target="#food-${dayId}" class="tab-button active text-lg px-4 py-2 border-b-2 border-transparent transition-colors">·∫®m th·ª±c üçî</button>
                                            <button data-tab-target="#accom-${dayId}" class="tab-button text-lg px-4 py-2 border-b-2 border-transparent transition-colors">N∆°i ·ªü üè®</button>
                                            <button data-tab-target="#other-${dayId}" class="tab-button text-lg px-4 py-2 border-b-2 border-transparent transition-colors">Kh√°c üéüÔ∏è</button>
                                        </div>
                                        <div id="food-${dayId}" data-tab-content class="active space-y-4">
                                            <div>
                                                <label for="food-details-${dayId}" class="block text-sm font-medium text-slate-600">G·ª£i √Ω / L·ª±a ch·ªçn nh√† h√†ng</label>
                                                <textarea id="food-details-${dayId}" rows="3" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500">${dayData.food.join('\n')}</textarea>
                                            </div>
                                            <div>
                                                <label for="food-cost-${dayId}" class="block text-sm font-medium text-slate-600">T·ªïng chi ph√≠ ƒÉn u·ªëng (VNƒê)</label>
                                                <input type="number" id="food-cost-${dayId}" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500" value="${dayData.foodCost}">
                                            </div>
                                        </div>
                                        <div id="accom-${dayId}" data-tab-content class="space-y-4">
                                            <div>
                                                <label for="accom-details-${dayId}" class="block text-sm font-medium text-slate-600">G·ª£i √Ω / L·ª±a ch·ªçn kh√°ch s·∫°n</label>
                                                <textarea id="accom-details-${dayId}" rows="3" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500">${dayData.accommodation.join('\n')}</textarea>
                                            </div>
                                            <div>
                                                <label for="accom-cost-${dayId}" class="block text-sm font-medium text-slate-600">T·ªïng chi ph√≠ n∆°i ·ªü (VNƒê)</label>
                                                <input type="number" id="accom-cost-${dayId}" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500" value="${dayData.accommodationCost}">
                                            </div>
                                        </div>
                                        <div id="other-${dayId}" data-tab-content class="space-y-4">
                                            <div>
                                                <label for="other-cost-${dayId}" class="block text-sm font-medium text-slate-600">Chi ph√≠ kh√°c (v√©, xƒÉng xe, v.v.)</label>
                                                <input type="number" id="other-cost-${dayId}" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-orange-500 focus:ring-orange-500" value="${dayData.otherCost}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-4 pt-6">
                                        <button type="button" class="update-btn bg-orange-500 text-white font-semibold py-2 px-5 rounded-lg hover:bg-orange-600 transition-colors" data-day-index="${index}">C·∫≠p nh·∫≠t</button>
                                        <span id="feedback-${dayId}" class="text-green-600 font-medium opacity-0 update-feedback">ƒê√£ c·∫≠p nh·∫≠t!</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="md:col-span-1 flex flex-col items-center justify-center bg-slate-50 rounded-xl p-6">
                                <h3 class="text-xl font-semibold text-slate-700 mb-4 text-center">Chi ph√≠ d·ª± ki·∫øn</h3>
                                <div class="chart-container">
                                    <canvas id="chart-${dayId}"></canvas>
                                </div>
                                <p class="text-center mt-4 text-slate-600">T·ªïng c·ªông: <strong id="total-cost-${dayId}" class="text-lg text-orange-600">${totalCost.toLocaleString('vi-VN')} VNƒê</strong></p>
                                <p class="text-center text-sm text-slate-500">(∆Ø·ªõc t√≠nh cho 5 ng∆∞·ªùi/ng√†y)</p>
                            </div>
                        </div>
                    </section>
                `;
                itineraryContainer.innerHTML += cardHTML;
            });

            createCharts();
            setupEventListeners();
        }

        function createCharts() {
            tripData.forEach(dayData => {
                const dayId = `day-${dayData.day}`;
                const ctx = document.getElementById(`chart-${dayId}`).getContext('2d');
                const chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ƒÇn u·ªëng', 'N∆°i ·ªü', 'Kh√°c'],
                        datasets: [{
                            label: 'Chi ph√≠',
                            data: [dayData.foodCost, dayData.accommodationCost, dayData.otherCost],
                            backgroundColor: ['#fb923c', '#475569', '#a8a29e'], // Orange, Slate, Stone
                            borderColor: '#ffffff',
                            borderWidth: 4,
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false, cutout: '65%',
                        plugins: {
                            legend: { position: 'bottom', labels: { padding: 20, font: { size: 14 } } },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) { label += ': '; }
                                        if (context.parsed !== null) {
                                            label += new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(context.parsed);
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
                charts.push(chart);
            });
        }

        function setupEventListeners() {
            // Tab switching logic
            const tabs = document.querySelectorAll('[data-tab-target]');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = document.querySelector(tab.dataset.tabTarget);
                    const tabGroup = tab.closest('.tabs');
                    
                    tabGroup.querySelectorAll('[data-tab-content]').forEach(c => c.classList.remove('active'));
                    tabGroup.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                    
                    tab.classList.add('active');
                    target.classList.add('active');
                });
            });

            // --- Password Modal Logic ---
            let currentUpdateDayIndex = null;
            const passwordModal = document.getElementById('password-modal');
            const alertModal = document.getElementById('alert-modal');
            const passwordInput = document.getElementById('password-input');
            const modalConfirm = document.getElementById('modal-confirm');
            const modalCancel = document.getElementById('modal-cancel');
            const alertOk = document.getElementById('alert-ok');

            function showPasswordPrompt(dayIndex) {
                currentUpdateDayIndex = dayIndex;
                passwordInput.value = '';
                passwordModal.classList.remove('hidden');
                passwordModal.classList.add('flex');
                passwordInput.focus();
            }

            function showAlert(message) {
                document.getElementById('alert-message').textContent = message;
                alertModal.classList.remove('hidden');
                alertModal.classList.add('flex');
            }

            function hideModals() {
                passwordModal.classList.add('hidden');
                passwordModal.classList.remove('flex');
                alertModal.classList.add('hidden');
                alertModal.classList.remove('flex');
            }

            itineraryContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('update-btn')) {
                    const dayIndex = parseInt(e.target.dataset.dayIndex);
                    showPasswordPrompt(dayIndex);
                }
            });

            modalConfirm.addEventListener('click', () => {
                if (passwordInput.value === "summer25") {
                    hideModals();
                    performUpdate(currentUpdateDayIndex);
                } else {
                    hideModals();
                    showAlert("M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng. C·∫≠p nh·∫≠t ƒë√£ b·ªã h·ªßy.");
                }
            });

            passwordInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    modalConfirm.click();
                }
            });

            modalCancel.addEventListener('click', hideModals);
            alertOk.addEventListener('click', hideModals);

            function performUpdate(dayIndex) {
                if (dayIndex === null) return;

                const dayId = `day-${tripData[dayIndex].day}`;
                // Get new values from all editable fields
                const newActivityDetails = document.getElementById(`activity-details-${dayId}`).value.split('\n');
                const newFoodDetails = document.getElementById(`food-details-${dayId}`).value.split('\n');
                const newAccomDetails = document.getElementById(`accom-details-${dayId}`).value.split('\n');
                const newFoodCost = parseInt(document.getElementById(`food-cost-${dayId}`).value) || 0;
                const newAccomCost = parseInt(document.getElementById(`accom-cost-${dayId}`).value) || 0;
                const newOtherCost = parseInt(document.getElementById(`other-cost-${dayId}`).value) || 0;

                // Update the main data object
                tripData[dayIndex] = {
                    ...tripData[dayIndex],
                    activities: newActivityDetails,
                    food: newFoodDetails,
                    accommodation: newAccomDetails,
                    foodCost: newFoodCost,
                    accommodationCost: newAccomCost,
                    otherCost: newOtherCost
                };
                
                // Update the chart
                charts[dayIndex].data.datasets[0].data = [newFoodCost, newAccomCost, newOtherCost];
                charts[dayIndex].update();

                // Update the total cost display
                const totalCostEl = document.getElementById(`total-cost-${dayId}`);
                const totalCost = newFoodCost + newAccomCost + newOtherCost;
                totalCostEl.textContent = `${totalCost.toLocaleString('vi-VN')} VNƒê`;

                // Show feedback message
                const feedbackEl = document.getElementById(`feedback-${dayId}`);
                feedbackEl.style.opacity = 1;
                setTimeout(() => {
                    feedbackEl.style.opacity = 0;
                }, 2000);
            }

            // --- Navigation highlighting on scroll ---
            const navLinks = document.querySelectorAll('.nav-button');
            const sections = document.querySelectorAll('.day-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { root: null, rootMargin: '0px', threshold: 0.4 });
            sections.forEach(section => observer.observe(section));
        }

        // Use window.onload to ensure all external resources like Chart.js are loaded
        window.onload = renderApp;

    </script>

</body>
</html>
